---
// PHASE 2 MIGRATION: Refactored to use base components
// - IconBadge.astro replaces .icon-wrapper styling (~20 lines removed)
// - ContentCard.astro replaces .access-card styling (~30 lines removed)
// - Kept component-specific: .top-accent, .corner-decoration
import { storyblokEditable } from "@storyblok/astro";
import { renderText } from "../../../utils/storyblok";
import type { BereikbaarheidProps, ToeankelijkBlok } from "./types";
import ContentCard from "../../../components/bereikbaarheid/ContentCard.astro";
import IconBadge from "../../../components/bereikbaarheid/IconBadge.astro";

interface Props extends BereikbaarheidProps<ToeankelijkBlok> {}

const { blok } = Astro.props;

// Storyblok field mapping: title (text), text (richtext)
const title = blok.title || "";
const tekst = blok.tekst; // Richtext field

// Render richtext content to HTML
const renderedText = renderText(tekst);
---

<section
  {...storyblokEditable(blok)}
  class="access-section !bg-transparent relative overflow-hidden"
>
  <div class="section-container content-layer">
    <!-- Compact centered layout with highlighted border -->
    <div class="max-w-5xl mx-auto">
      <ContentCard
        variant="elevated"
        padding="lg"
        maxWidth="full"
        hoverEffect={true}
      >
        <!-- Top accent border - component-specific -->
        <div class="top-accent"></div>

        <!-- Content wrapper -->
        <div class="card-wrapper">
          {
            title && (
              <div class="header-section">
                <IconBadge
                  icon="â™¿"
                  variant="accent"
                  size="lg"
                  animation="none"
                />
                <h2 class="access-title">{title}</h2>
              </div>
            )
          }

          {
            renderedText && (
              <div class="content-section prose-base prose-accent">
                <Fragment set:html={renderedText} />
              </div>
            )
          }
        </div>

        <!-- Decorative corner elements - component-specific -->
        <div class="corner-decoration top-left"></div>
        <div class="corner-decoration bottom-right"></div>
      </ContentCard>
    </div>
  </div>
</section>

<style>
  .access-section {
    /* Background handled by utility class */
  }

  /* Background pattern layer - sits at base layer */
  .pattern-background {
    z-index: var(--z-base);
    pointer-events: none;
  }

  /* Content layer - sits above background */
  .content-layer {
    z-index: var(--z-content);
  }

  /* Top accent border - sits at content layer - component-specific */
  .top-accent {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 0.375rem;
    background: linear-gradient(
      90deg,
      var(--color-accent) 0%,
      var(--color-accent-dark) 50%,
      var(--color-accent) 100%
    );
    z-index: var(--z-content);
  }

  .card-wrapper {
    position: relative;
    margin-top: 0.375rem;
  }

  /* Header section */
  .header-section {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 2.5rem;
    padding-bottom: 2rem;
    border-bottom: 2px solid var(--border-secondary);
  }

  @media (max-width: 767px) {
    .header-section {
      flex-direction: column;
      text-align: center;
    }
  }

  .access-title {
    font-size: 2rem;
    font-weight: 800;
    line-height: 1.2;
    color: var(--text-primary);
    letter-spacing: -0.01em;
    flex: 1;
  }

  @media (min-width: 768px) {
    .access-title {
      font-size: 2.5rem;
    }
  }

  /* Content section */
  .content-section {
    position: relative;
  }

  /* Corner decorations - sit at base layer - component-specific */
  .corner-decoration {
    position: absolute;
    width: 3rem;
    height: 3rem;
    pointer-events: none;
    z-index: var(--z-base);
  }

  /* Decoration lines sit at base layer */
  .corner-decoration::before,
  .corner-decoration::after {
    content: "";
    position: absolute;
    background: var(--color-accent);
    opacity: 0.15;
    z-index: var(--z-base);
  }

  .corner-decoration.top-left {
    top: 1rem;
    left: 1rem;
  }

  .corner-decoration.top-left::before {
    top: 0;
    left: 0;
    width: 100%;
    height: 2px;
  }

  .corner-decoration.top-left::after {
    top: 0;
    left: 0;
    width: 2px;
    height: 100%;
  }

  .corner-decoration.bottom-right {
    bottom: 1rem;
    right: 1rem;
  }

  .corner-decoration.bottom-right::before {
    bottom: 0;
    right: 0;
    width: 100%;
    height: 2px;
  }

  .corner-decoration.bottom-right::after {
    bottom: 0;
    right: 0;
    width: 2px;
    height: 100%;
  }
</style>
