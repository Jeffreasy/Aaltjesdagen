---
import "../styles/global.css";
import Navigation from "../components/layout/Navigation.astro";
import Footer from "../components/layout/Footer.astro";
import BackToTop from "../components/layout/BackToTop.astro";

interface Props {
  title?: string;
}

const { title = "Aaltjesdagen" } = Astro.props;
const isStoryblokEnabled = import.meta.env.DEV;
---

<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>

    <!-- Theme Detection Script (no-flash) -->
    <script is:inline>
      // Apply theme before body renders to prevent flash
      (function () {
        const theme =
          localStorage.getItem("theme") ||
          (window.matchMedia("(prefers-color-scheme: dark)").matches
            ? "dark"
            : "light");
        document.documentElement.setAttribute("data-theme", theme);
        if (theme === "dark") {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
  </head>
  <body class="flex flex-col min-h-screen">
    <!-- Animated Background -->
    <div class="fixed inset-0 z-[-1] bg-animated" aria-hidden="true">
      <div class="orb absolute w-[500px] h-[500px] bottom-[25%] left-[50%] blur-[80px] opacity-60 rounded-full [background:var(--bg-gradient-animated-3)] [animation:float-3_30s_ease-in-out_infinite]">
      </div>
    </div>
    <header
      class="glass sticky top-0 py-4 shadow-lg border-b border-white/30 dark:border-gray-700/30 relative z-header"
    >
      <div
        class="container-custom flex flex-row justify-between items-center gap-4"
      >
        <a href="/" class="flex items-center gap-3 group">
          <img
            src="/assets/logo.png"
            alt="Aaltjesdagen Logo"
            width="180"
            height="60"
            class="h-12 w-auto transition-all duration-300 group-hover:scale-105 brightness-0 dark:invert"
          />
        </a>
        <Navigation />
      </div>

      <!-- Decorative Gradient Bottom Border -->
      <div
        class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-secondary via-accent to-primary"
        aria-hidden="true"
      >
      </div>
    </header>

    <main class="flex-grow relative">
      <slot />
    </main>

    <BackToTop />
    <Footer />

    {
      isStoryblokEnabled && (
        <script
          is:inline
          src="https://app.storyblok.com/f/storyblok-v2-latest.js"
        />
      )
    }

    <!-- Alpine.js - Bundled -->
    <script>
      import Alpine from "alpinejs";

      window.Alpine = Alpine;
      Alpine.start();
    </script>
  </body>
</html>
