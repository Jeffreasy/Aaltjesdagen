---
/**
 * FilterBar Component
 * 
 * Reusable filter bar with glassmorphism styling for filtering content by location.
 * Eliminates duplication between ProgrammaDag and Grid components.
 * 
 * @component
 * @example
 * <FilterBar 
 *   locations={['Binnenstad', 'Park']}
 *   showCount={true}
 *   items={programmas}
 *   gradientVariant="teal"
 *   spacing="sm"
 * />
 */

interface Props {
  /** Array of location strings for filter buttons */
  locations: string[];
  
  /** Whether to show item counts in parentheses */
  showCount?: boolean;
  
  /** Full items array for count calculation (required if showCount is true) */
  items?: any[];
  
  /** Gradient color variant for active filter button */
  gradientVariant?: 'teal' | 'blue';
  
  /** Spacing below filter bar */
  spacing?: 'sm' | 'lg';
}

const { 
  locations, 
  showCount = false, 
  items = [], 
  gradientVariant = 'teal',
  spacing = 'sm'
} = Astro.props;

// Calculate total count for "All" button
const totalCount = items.length;

// Calculate count per location
const getLocationCount = (location: string) => {
  if (!items || items.length === 0) return 0;
  return items.filter((item: any) => {
    const itemLocation = item.Locatie || item.locatie;
    return itemLocation === location;
  }).length;
};

// Gradient class based on variant
const gradientClass = gradientVariant === 'teal' 
  ? 'from-primary to-teal-600' 
  : 'from-primary to-blue-700';

// Spacing class
const spacingClass = spacing === 'sm' ? 'mb-10' : 'mb-20';
---

<div 
  class:list={['sticky top-20 flex justify-center', spacingClass]}
  style="z-index: var(--z-sticky);"
>
  <div class="glass p-3 rounded-2xl shadow-2xl flex flex-wrap justify-center gap-2 max-w-full overflow-x-auto no-scrollbar">
    <!-- "All" filter button -->
    <button
      @click="activeFilter = 'all'"
      :class={`activeFilter === 'all' ? 'bg-gradient-to-r ${gradientClass} text-white shadow-lg scale-105' : 'hover:bg-white/70 hover:scale-105'`}
      style="color: var(--text-primary);"
      class="px-5 py-2 rounded-xl text-xs md:text-sm font-bold transition-all duration-300 whitespace-nowrap"
    >
      Alles{showCount && totalCount > 0 ? ` (${totalCount})` : ''}
    </button>

    <!-- Location filter buttons -->
    {locations.map((location: string) => {
      const count = showCount ? getLocationCount(location) : 0;
      return (
        <button
          @click={`activeFilter = '${location}'`}
          :class={`activeFilter === '${location}' ? 'bg-gradient-to-r ${gradientClass} text-white shadow-lg scale-105' : 'hover:bg-white/70 hover:scale-105'`}
          style="color: var(--text-primary);"
          class="px-5 py-2 rounded-xl text-xs md:text-sm font-bold transition-all duration-300 whitespace-nowrap"
        >
          {location}{showCount && count > 0 ? ` (${count})` : ''}
        </button>
      );
    })}
  </div>
</div>

<style>
  /* Hide scrollbar for filter overflow on mobile */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>
